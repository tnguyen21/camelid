âœ“ Initialized. View run at https://modal.com/apps/tommynguyen0512/main/ap-YEwCweZ1Tsf0qdpUBwied2
âœ“ Created objects.
â”œâ”€â”€ ðŸ”¨ Created mount train_llama.py
â”œâ”€â”€ ðŸ”¨ Created mount /home/tau/projects/camelid/scripts/modal_train.py
â””â”€â”€ ðŸ”¨ Created function run_training.
STDOUT:
tokens per iteration: 32,768
breakdown: config.gradient_accumulation_steps=1 * ddp_world_size=8 * config.batch_size=4 * config.max_seq_len=1024
decayed params: 85 tensors, 2,634,354,688 parameters
non-decayed params: 25 tensors, 102,400 parameters
using fused AdamW: True
Python 3.11.10 (main, Dec  3 2024, 02:25:00) [GCC 12.2.0]
PyTorch 2.9.0.dev20250908+cu126 (CUDA 12.6)
Thu Oct  2 18:57:00 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 575.57.08              Driver Version: 575.57.08      CUDA Version: 12.9     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA H100 80GB HBM3          On  |   00000000:04:00.0 Off |                    0 |
| N/A   36C    P0            130W /  700W |   22929MiB /  81559MiB |      7%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA H100 80GB HBM3          On  |   00000000:05:00.0 Off |                    0 |
| N/A   35C    P0            134W /  700W |   22929MiB /  81559MiB |     72%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA H100 80GB HBM3          On  |   00000000:0A:00.0 Off |                    0 |
| N/A   39C    P0            142W /  700W |   22929MiB /  81559MiB |     32%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA H100 80GB HBM3          On  |   00000000:0B:00.0 Off |                    0 |
| N/A   36C    P0            137W /  700W |   22929MiB /  81559MiB |     94%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   4  NVIDIA H100 80GB HBM3          On  |   00000000:84:00.0 Off |                    0 |
| N/A   44C    P0            141W /  700W |   22929MiB /  81559MiB |     71%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   5  NVIDIA H100 80GB HBM3          On  |   00000000:85:00.0 Off |                    0 |
| N/A   41C    P0            141W /  700W |   22929MiB /  81559MiB |     76%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   6  NVIDIA H100 80GB HBM3          On  |   00000000:8A:00.0 Off |                    0 |
| N/A   37C    P0            139W /  700W |   22929MiB /  81559MiB |     99%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   7  NVIDIA H100 80GB HBM3          On  |   00000000:8B:00.0 Off |                    0 |
| N/A   41C    P0            138W /  700W |   22929MiB /  81559MiB |      7%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    0   N/A  N/A               1      C   /bin/dumb-init                        22920MiB |
|    1   N/A  N/A               1      C   /bin/dumb-init                        22920MiB |
|    2   N/A  N/A               1      C   /bin/dumb-init                        22920MiB |
|    3   N/A  N/A               1      C   /bin/dumb-init                        22920MiB |
|    4   N/A  N/A               1      C   /bin/dumb-init                        22920MiB |
|    5   N/A  N/A               1      C   /bin/dumb-init                        22920MiB |
|    6   N/A  N/A               1      C   /bin/dumb-init                        22920MiB |
|    7   N/A  N/A               1      C   /bin/dumb-init                        22920MiB |
+-----------------------------------------------------------------------------------------+

step 0: train loss 11.6356, val loss 11.6365
0 | loss 11.6599 | lr 0.000000e+00 | 20424.32ms | mfu 0.17%
1 | loss 11.6632 | lr 3.000000e-05 | 299.85ms | mfu 11.33%
2 | loss 10.3879 | lr 6.000000e-05 | 336.83ms | mfu 10.08%
3 | loss 11.9233 | lr 9.000000e-05 | 332.60ms | mfu 10.21%
4 | loss 20.2888 | lr 1.200000e-04 | 331.68ms | mfu 10.24%
5 | loss 16.1192 | lr 1.500000e-04 | 331.17ms | mfu 10.26%
6 | loss 16.3839 | lr 1.800000e-04 | 330.93ms | mfu 10.26%
7 | loss 23.8454 | lr 2.100000e-04 | 330.98ms | mfu 10.26%
8 | loss 18.4015 | lr 2.400000e-04 | 331.42ms | mfu 10.25%
9 | loss 16.9090 | lr 2.700000e-04 | 330.99ms | mfu 10.26%
10 | loss 15.5493 | lr 3.000000e-04 | 330.84ms | mfu 10.27%
11 | loss 13.9788 | lr 2.999086e-04 | 331.84ms | mfu 10.24%
12 | loss 12.8197 | lr 2.996346e-04 | 331.04ms | mfu 10.26%
13 | loss 12.0816 | lr 2.991783e-04 | 330.93ms | mfu 10.26%
14 | loss 10.8386 | lr 2.985402e-04 | 331.33ms | mfu 10.25%
15 | loss 10.0782 | lr 2.977212e-04 | 331.49ms | mfu 10.25%
16 | loss 10.5042 | lr 2.967221e-04 | 330.16ms | mfu 10.29%
17 | loss 9.2281 | lr 2.955444e-04 | 330.23ms | mfu 10.29%
18 | loss 8.6424 | lr 2.941893e-04 | 329.62ms | mfu 10.30%
19 | loss 9.0127 | lr 2.926585e-04 | 331.07ms | mfu 10.26%
20 | loss 8.0397 | lr 2.909539e-04 | 330.31ms | mfu 10.28%
21 | loss 8.2331 | lr 2.890776e-04 | 330.17ms | mfu 10.29%
22 | loss 8.8911 | lr 2.870318e-04 | 330.49ms | mfu 10.28%
23 | loss 8.5819 | lr 2.848191e-04 | 330.48ms | mfu 10.28%
24 | loss 8.2449 | lr 2.824421e-04 | 330.02ms | mfu 10.29%
25 | loss 8.6014 | lr 2.799038e-04 | 331.04ms | mfu 10.26%
26 | loss 8.0544 | lr 2.772072e-04 | 330.34ms | mfu 10.28%
27 | loss 8.0709 | lr 2.743556e-04 | 330.49ms | mfu 10.28%
28 | loss 8.2611 | lr 2.713525e-04 | 330.45ms | mfu 10.28%
29 | loss 7.7057 | lr 2.682016e-04 | 331.69ms | mfu 10.24%
30 | loss 8.5367 | lr 2.649067e-04 | 330.05ms | mfu 10.29%
31 | loss 7.8784 | lr 2.614717e-04 | 330.93ms | mfu 10.26%
32 | loss 8.2575 | lr 2.579010e-04 | 330.13ms | mfu 10.29%
33 | loss 8.3672 | lr 2.541988e-04 | 330.66ms | mfu 10.27%
34 | loss 8.2497 | lr 2.503696e-04 | 330.41ms | mfu 10.28%
35 | loss 7.6127 | lr 2.464181e-04 | 330.73ms | mfu 10.27%
36 | loss 8.1180 | lr 2.423492e-04 | 330.12ms | mfu 10.29%
37 | loss 8.1394 | lr 2.381678e-04 | 331.06ms | mfu 10.26%
38 | loss 7.9278 | lr 2.338789e-04 | 331.38ms | mfu 10.25%
39 | loss 8.2543 | lr 2.294879e-04 | 331.35ms | mfu 10.25%
40 | loss 7.7479 | lr 2.250000e-04 | 330.88ms | mfu 10.27%
41 | loss 8.3095 | lr 2.204207e-04 | 330.12ms | mfu 10.29%
42 | loss 8.0866 | lr 2.157557e-04 | 330.50ms | mfu 10.28%
43 | loss 8.0422 | lr 2.110105e-04 | 330.76ms | mfu 10.27%
44 | loss 7.7196 | lr 2.061910e-04 | 330.06ms | mfu 10.29%
45 | loss 7.5181 | lr 2.013030e-04 | 331.00ms | mfu 10.26%
Training completed with return code: 0
Stopping app - local entrypoint completed.
46 | loss 7.8550 | lr 1.963525e-04 | 330.69ms | mfu 10.27%
47 | loss 8.0039 | lr 1.913456e-04 | 329.97ms | mfu 10.29%
48 | loss 7.7953 | lr 1.862883e-04 | 330.23ms | mfu 10.29%
49 | loss 7.7652 | lr 1.811868e-04 | 330.24ms | mfu 10.29%
50 | loss 7.3249 | lr 1.760472e-04 | 330.50ms | mfu 10.28%
51 | loss 7.3769 | lr 1.708760e-04 | 330.76ms | mfu 10.27%
52 | loss 7.8760 | lr 1.656793e-04 | 332.07ms | mfu 10.23%
53 | loss 7.6497 | lr 1.604635e-04 | 330.72ms | mfu 10.27%
54 | loss 7.9043 | lr 1.552349e-04 | 330.41ms | mfu 10.28%
55 | loss 7.7175 | lr 1.500000e-04 | 331.28ms | mfu 10.25%
56 | loss 7.3845 | lr 1.447651e-04 | 330.56ms | mfu 10.28%
57 | loss 7.4078 | lr 1.395365e-04 | 330.74ms | mfu 10.27%
58 | loss 7.9658 | lr 1.343207e-04 | 329.81ms | mfu 10.30%
59 | loss 7.6744 | lr 1.291240e-04 | 331.13ms | mfu 10.26%
60 | loss 7.0828 | lr 1.239528e-04 | 330.43ms | mfu 10.28%
61 | loss 8.2140 | lr 1.188132e-04 | 330.30ms | mfu 10.28%
62 | loss 7.7358 | lr 1.137117e-04 | 330.51ms | mfu 10.28%
63 | loss 7.7009 | lr 1.086544e-04 | 330.62ms | mfu 10.27%
64 | loss 7.4541 | lr 1.036475e-04 | 330.69ms | mfu 10.27%
65 | loss 7.5779 | lr 9.869698e-05 | 330.62ms | mfu 10.27%
66 | loss 7.5690 | lr 9.380901e-05 | 330.44ms | mfu 10.28%
67 | loss 7.8727 | lr 8.898950e-05 | 330.51ms | mfu 10.28%
68 | loss 7.5504 | lr 8.424433e-05 | 331.27ms | mfu 10.25%
69 | loss 7.3961 | lr 7.957927e-05 | 330.38ms | mfu 10.28%
70 | loss 7.1403 | lr 7.500000e-05 | 330.39ms | mfu 10.28%
71 | loss 7.5846 | lr 7.051211e-05 | 331.08ms | mfu 10.26%
72 | loss 7.6759 | lr 6.612106e-05 | 330.98ms | mfu 10.26%
73 | loss 7.3499 | lr 6.183221e-05 | 330.98ms | mfu 10.26%
74 | loss 8.9396 | lr 5.765078e-05 | 331.03ms | mfu 10.26%
75 | loss 7.8522 | lr 5.358186e-05 | 332.08ms | mfu 10.23%
76 | loss 7.5871 | lr 4.963041e-05 | 331.27ms | mfu 10.25%
77 | loss 6.9080 | lr 4.580124e-05 | 331.30ms | mfu 10.25%
78 | loss 7.8429 | lr 4.209903e-05 | 330.56ms | mfu 10.28%
79 | loss 8.1401 | lr 3.852828e-05 | 331.65ms | mfu 10.24%
80 | loss 7.2520 | lr 3.509333e-05 | 331.01ms | mfu 10.26%
81 | loss 6.8808 | lr 3.179839e-05 | 331.69ms | mfu 10.24%
82 | loss 7.5924 | lr 2.864745e-05 | 330.53ms | mfu 10.28%
83 | loss 7.2323 | lr 2.564436e-05 | 332.33ms | mfu 10.22%
84 | loss 7.7012 | lr 2.279279e-05 | 331.00ms | mfu 10.26%
85 | loss 7.8084 | lr 2.009619e-05 | 332.79ms | mfu 10.21%
86 | loss 7.5263 | lr 1.755786e-05 | 331.95ms | mfu 10.23%
87 | loss 7.3475 | lr 1.518089e-05 | 332.89ms | mfu 10.20%
88 | loss 6.9954 | lr 1.296818e-05 | 331.71ms | mfu 10.24%
89 | loss 8.2478 | lr 1.092242e-05 | 331.56ms | mfu 10.24%
90 | loss 6.8705 | lr 9.046107e-06 | 331.75ms | mfu 10.24%
91 | loss 8.1125 | lr 7.341523e-06 | 331.72ms | mfu 10.24%
92 | loss 6.8562 | lr 5.810746e-06 | 331.23ms | mfu 10.25%
93 | loss 7.4966 | lr 4.455641e-06 | 331.07ms | mfu 10.26%
94 | loss 7.4194 | lr 3.277860e-06 | 331.61ms | mfu 10.24%
95 | loss 7.3767 | lr 2.278837e-06 | 331.41ms | mfu 10.25%
96 | loss 7.6637 | lr 1.459790e-06 | 331.67ms | mfu 10.24%
97 | loss 7.3600 | lr 8.217157e-07 | 333.08ms | mfu 10.20%
98 | loss 7.5981 | lr 3.653925e-07 | 331.65ms | mfu 10.24%
99 | loss 7.7292 | lr 9.137595e-08 | 332.50ms | mfu 10.22%
100 | loss 7.5648 | lr 0.000000e+00 | 331.05ms | mfu 10.26%

STDERR:

Return code: 0
âœ“ App completed. View run at https://modal.com/apps/tommynguyen0512/main/ap-YEwCweZ1Tsf0qdpUBwied2
