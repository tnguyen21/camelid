âœ“ Initialized. View run at https://modal.com/apps/tommynguyen0512/main/ap-28vLljNeRNlseobICmXXZF
âœ“ Created objects.
â”œâ”€â”€ ðŸ”¨ Created mount train_llama.py
â”œâ”€â”€ ðŸ”¨ Created mount /home/tau/projects/camelid/scripts/modal_train.py
â””â”€â”€ ðŸ”¨ Created function run_training.
STDOUT:
tokens per iteration: 32,768
breakdown: config.gradient_accumulation_steps=2 * ddp_world_size=4 * config.batch_size=4 * config.max_seq_len=1024
decayed params: 85 tensors, 123,532,032 parameters
non-decayed params: 25 tensors, 19,200 parameters
using fused AdamW: True
Python 3.11.10 (main, Dec  3 2024, 02:25:00) [GCC 12.2.0]
PyTorch 2.9.0.dev20250908+cu126 (CUDA 12.6)
Thu Oct  2 19:04:20 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 575.57.08              Driver Version: 575.57.08      CUDA Version: 12.9     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA L4                      On  |   00000000:80:00.0 Off |                    0 |
| N/A   52C    P0             30W /   72W |    1861MiB /  23034MiB |     29%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA L4                      On  |   00000000:80:01.0 Off |                    0 |
| N/A   55C    P0             29W /   72W |    1861MiB /  23034MiB |     30%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA L4                      On  |   00000000:80:02.0 Off |                    0 |
| N/A   63C    P0             34W /   72W |    1861MiB /  23034MiB |     21%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA L4                      On  |   00000000:80:03.0 Off |                    0 |
| N/A   54C    P0             30W /   72W |    1861MiB /  23034MiB |     34%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    0   N/A  N/A               1      C   /bin/dumb-init                         1852MiB |
|    1   N/A  N/A               1      C   /bin/dumb-init                         1852MiB |
|    2   N/A  N/A               1      C   /bin/dumb-init                         1852MiB |
|    3   N/A  N/A               1      C   /bin/dumb-init                         1852MiB |
+-----------------------------------------------------------------------------------------+

step 0: train loss 10.9814, val loss 10.9729
0 | loss 10.9655 | lr 0.000000e+00 | 27084.36ms | mfu 0.01%
1 | loss 10.9863 | lr 3.000000e-05 | 611.39ms | mfu 0.58%
2 | loss 10.5560 | lr 6.000000e-05 | 822.03ms | mfu 0.43%
3 | loss 10.0471 | lr 9.000000e-05 | 824.09ms | mfu 0.43%
4 | loss 9.8016 | lr 1.200000e-04 | 825.45ms | mfu 0.43%
5 | loss 9.5003 | lr 1.500000e-04 | 815.53ms | mfu 0.43%
6 | loss 9.5024 | lr 1.800000e-04 | 822.63ms | mfu 0.43%
7 | loss 9.5964 | lr 2.100000e-04 | 818.04ms | mfu 0.43%
8 | loss 9.3386 | lr 2.400000e-04 | 821.56ms | mfu 0.43%
9 | loss 9.0490 | lr 2.700000e-04 | 820.49ms | mfu 0.43%
10 | loss 8.9569 | lr 3.000000e-04 | 822.64ms | mfu 0.43%
11 | loss 8.9539 | lr 2.999086e-04 | 821.71ms | mfu 0.43%
12 | loss 8.5954 | lr 2.996346e-04 | 825.90ms | mfu 0.43%
13 | loss 8.5410 | lr 2.991783e-04 | 828.44ms | mfu 0.43%
14 | loss 8.4134 | lr 2.985402e-04 | 807.00ms | mfu 0.44%
15 | loss 8.1387 | lr 2.977212e-04 | 824.87ms | mfu 0.43%
16 | loss 8.2158 | lr 2.967221e-04 | 827.25ms | mfu 0.43%
17 | loss 7.8538 | lr 2.955444e-04 | 822.90ms | mfu 0.43%
18 | loss 8.0305 | lr 2.941893e-04 | 827.26ms | mfu 0.43%
19 | loss 7.6208 | lr 2.926585e-04 | 825.98ms | mfu 0.43%
20 | loss 7.6457 | lr 2.909539e-04 | 823.97ms | mfu 0.43%
21 | loss 8.1195 | lr 2.890776e-04 | 825.98ms | mfu 0.43%
22 | loss 7.6223 | lr 2.870318e-04 | 831.54ms | mfu 0.43%
23 | loss 7.6005 | lr 2.848191e-04 | 816.37ms | mfu 0.43%
24 | loss 7.3379 | lr 2.824421e-04 | 829.61ms | mfu 0.43%
25 | loss 7.7134 | lr 2.799038e-04 | 826.57ms | mfu 0.43%
26 | loss 7.5677 | lr 2.772072e-04 | 827.32ms | mfu 0.43%
27 | loss 7.4140 | lr 2.743556e-04 | 823.00ms | mfu 0.43%
28 | loss 7.7319 | lr 2.713525e-04 | 832.20ms | mfu 0.43%
29 | loss 7.2435 | lr 2.682016e-04 | 826.45ms | mfu 0.43%
30 | loss 7.2152 | lr 2.649067e-04 | 832.28ms | mfu 0.43%
31 | loss 7.4088 | lr 2.614717e-04 | 828.07ms | mfu 0.43%
32 | loss 7.1609 | lr 2.579010e-04 | 831.94ms | mfu 0.43%
33 | loss 8.3307 | lr 2.541988e-04 | 827.25ms | mfu 0.43%
34 | loss 7.3514 | lr 2.503696e-04 | 828.16ms | mfu 0.43%
35 | loss 7.4367 | lr 2.464181e-04 | 830.08ms | mfu 0.43%
36 | loss 7.3410 | lr 2.423492e-04 | 830.89ms | mfu 0.43%
37 | loss 7.5032 | lr 2.381678e-04 | 830.29ms | mfu 0.43%
38 | loss 7.0515 | lr 2.338789e-04 | 831.58ms | mfu 0.43%
39 | loss 7.5709 | lr 2.294879e-04 | 829.27ms | mfu 0.43%
40 | loss 6.9484 | lr 2.250000e-04 | 833.60ms | mfu 0.42%
41 | loss 7.1471 | lr 2.204207e-04 | 826.27ms | mfu 0.43%
42 | loss 7.0371 | lr 2.157557e-04 | 831.46ms | mfu 0.43%
43 | loss 7.2820 | lr 2.110105e-04 | 830.78ms | mfu 0.43%
44 | loss 7.3605 | lr 2.061910e-04 | 831.08ms | mfu 0.43%
45 | loss 7.6117 | lr 2.013030e-04 | 834.18ms | mfu 0.42%
46 | loss 7.1358 | lr 1.963525e-04 | 833.04ms | mfu 0.42%
47 | loss 7.5135 | lr 1.913456e-04 | 831.58ms | mfu 0.43%
48 | loss 7.0037 | lr 1.862883e-04 | 832.63ms | mfu 0.42%
49 | loss 6.9547 | lr 1.811868e-04 | 833.32ms | mfu 0.42%
50 | loss 7.4442 | lr 1.760472e-04 | 833.70ms | mfu 0.42%
51 | loss 6.7399 | lr 1.708760e-04 | 831.85ms | mfu 0.43%
52 | loss 7.5738 | lr 1.656793e-04 | 832.71ms | mfu 0.42%
53 | loss 7.4626 | lr 1.604635e-04 | 832.45ms | mfu 0.42%
54 | loss 7.2138 | lr 1.552349e-04 | 835.21ms | mfu 0.42%
55 | loss 7.2057 | lr 1.500000e-04 | 834.11ms | mfu 0.42%
56 | loss 7.1298 | lr 1.447651e-04 | 833.07ms | mfu 0.42%
57 | loss 7.1827 | lr 1.395365e-04 | 833.41ms | mfu 0.42%
58 | loss 6.9212 | lr 1.343207e-04 | 832.56ms | mfu 0.42%
59 | loss 6.8494 | lr 1.291240e-04 | 832.18ms | mfu 0.43%
60 | loss 6.9351 | lr 1.239528e-04 | 831.25ms | mfu 0.43%
61 | loss 7.1072 | lr 1.188132e-04 | 832.02ms | mfu 0.43%
62 | loss 7.5952 | lr 1.137117e-04 | 829.13ms | mfu 0.43%
63 | loss 6.7096 | lr 1.086544e-04 | 829.90ms | mfu 0.43%
64 | loss 6.8069 | lr 1.036475e-04 | 832.58ms | mfu 0.42%
65 | loss 6.7300 | lr 9.869698e-05 | 830.72ms | mfu 0.43%
66 | loss 6.8890 | lr 9.380901e-05 | 835.49ms | mfu 0.42%
67 | loss 6.3446 | lr 8.898950e-05 | 827.90ms | mfu 0.43%
68 | loss 7.0257 | lr 8.424433e-05 | 834.09ms | mfu 0.42%
69 | loss 7.0369 | lr 7.957927e-05 | 828.00ms | mfu 0.43%
70 | loss 7.0169 | lr 7.500000e-05 | 830.92ms | mfu 0.43%
71 | loss 7.0198 | lr 7.051211e-05 | 834.08ms | mfu 0.42%
72 | loss 6.5066 | lr 6.612106e-05 | 829.87ms | mfu 0.43%
73 | loss 6.9975 | lr 6.183221e-05 | 832.77ms | mfu 0.42%
74 | loss 7.2440 | lr 5.765078e-05 | 830.30ms | mfu 0.43%
75 | loss 6.9773 | lr 5.358186e-05 | 830.36ms | mfu 0.43%
76 | loss 6.8769 | lr 4.963041e-05 | 827.23ms | mfu 0.43%
77 | loss 6.6701 | lr 4.580124e-05 | 828.91ms | mfu 0.43%
78 | loss 6.9655 | lr 4.209903e-05 | 808.51ms | mfu 0.44%
Training completed with return code: 0
Stopping app - local entrypoint completed.
79 | loss 7.0903 | lr 3.852828e-05 | 834.31ms | mfu 0.42%
80 | loss 6.9555 | lr 3.509333e-05 | 807.91ms | mfu 0.44%
81 | loss 6.8576 | lr 3.179839e-05 | 830.83ms | mfu 0.43%
82 | loss 7.0661 | lr 2.864745e-05 | 808.97ms | mfu 0.44%
83 | loss 6.6598 | lr 2.564436e-05 | 830.35ms | mfu 0.43%
84 | loss 7.0643 | lr 2.279279e-05 | 807.57ms | mfu 0.44%
85 | loss 6.8185 | lr 2.009619e-05 | 828.16ms | mfu 0.43%
86 | loss 6.4866 | lr 1.755786e-05 | 826.00ms | mfu 0.43%
87 | loss 7.3716 | lr 1.518089e-05 | 826.98ms | mfu 0.43%
88 | loss 6.6176 | lr 1.296818e-05 | 831.39ms | mfu 0.43%
89 | loss 6.9172 | lr 1.092242e-05 | 813.47ms | mfu 0.43%
90 | loss 7.1442 | lr 9.046107e-06 | 828.31ms | mfu 0.43%
91 | loss 7.3093 | lr 7.341523e-06 | 815.30ms | mfu 0.43%
92 | loss 7.6393 | lr 5.810746e-06 | 807.78ms | mfu 0.44%
93 | loss 6.7567 | lr 4.455641e-06 | 833.73ms | mfu 0.42%
94 | loss 6.8070 | lr 3.277860e-06 | 824.47ms | mfu 0.43%
95 | loss 7.8851 | lr 2.278837e-06 | 807.50ms | mfu 0.44%
96 | loss 6.5263 | lr 1.459790e-06 | 827.80ms | mfu 0.43%
97 | loss 6.6655 | lr 8.217157e-07 | 806.46ms | mfu 0.44%
98 | loss 6.9756 | lr 3.653925e-07 | 828.59ms | mfu 0.43%
99 | loss 7.2818 | lr 9.137595e-08 | 826.35ms | mfu 0.43%
100 | loss 6.5314 | lr 0.000000e+00 | 808.95ms | mfu 0.44%

STDERR:

Return code: 0
âœ“ App completed. View run at https://modal.com/apps/tommynguyen0512/main/ap-28vLljNeRNlseobICmXXZF
